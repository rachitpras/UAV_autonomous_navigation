---
layout: post
title:  "Trajectory tracking control for Quadcopters"
date:   2021-11-28 10:26:20 -0500
categories: Project explanation
---
In this article, I will discuss the architecture of the trajectory tracking controller used in my autonomous UAV navigation project. Please refer to the main article for more information regarding the autonomous navigation project. The goal of a trajectory tracking controller is to determine the appropriate control actuation that will enable the ego-vehicle to track the planned trajectory generated by the motion planner. Since, we are working with quadrotors, the control acutuation is in the form the rotation speed of the four propellors. Based on our literature survey, two different control architectures were experimented with. The first was PID based and the second was Model Predictive Control (MPC) based. 

As shown in the schematic below, both the control architectures follow a cascading control strategy, where the position and attitude control are carried out by different controllers. The position controller takes the desired position, velocity and acceleration as inputs and outputs the reference pitch, roll angles and the thrust force. The reference pitch, roll and yaw (from the planner) angles serve as it input for the attitude controller, which in turn outputs the reference pitch, roll and yaw moments.

<p align = "center">
  <img src="https://github.com/rachitpras/UAV_autonomous_navigation/blob/main/images/controller.JPG" alt="Schematic of the controller architecture" width="600"/> 
</p> 
<p align = "center">
  <b>Schematic of the controller architecture.</b>
</p> 

## Mapping the propeller speed from reference thrust and moments
Both the control architectures output the reference thrust and roll, pitch and yaw moments. These four references outputs are then need to be mapped to the rotor speeds of the four propellers. The mapping relation is given by the equations below, where U<sub>1-4</sub> are the thrust and roll, pitch and yaw moments respectively. *l* is the propeller arm length from the CG and CT and CQ are the thrust and moment coefficients respectively. 

<p align = "center">
  <img src="https://github.com/rachitpras/UAV_autonomous_navigation/blob/main/images/mapping_rotation_rate.JPG" alt="Mapping of the reference force and moments to the rotation rate" width="200"/> 
</p> 
<p align = "center">
  <b>Mapping of the reference force and moments to the rotation rate.</b>
</p> 
